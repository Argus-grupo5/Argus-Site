<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../css/dashboard/popup.css">
    <link rel="stylesheet" href="../../css/cssDashEduardo/style.css">
    <script src="../dashboard/script/dash.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <title>ARGUS | Dashboard</title>
</head>

<body>
    <div id="id_sair">
    </div>

    <header class="desktopNav" id="navDesktop"></header>
    <header class="headerTop">
        <div class="geralInfo">
            <div class="info tooltipInfo">
                <div class="server">
                    <img src="../../assets/dashboard/desktop/server.svg" alt="">
                </div>
                <div class="serversMonitoring" id="id_servidores_monitorados">
                </div>
                <span class="tooltiptextInfo">
                    Servidores em monitoramento
                </span>
            </div>
            <div class="info">
                <div class="bell">
                    <img src="../../assets/dashboard/desktop/bell.svg" alt="">
                </div>
                <div class="risk tooltipInfo" id="id_servidores_em_estado_critico">
                    <p id="qtd_critico"></p>
                    <span class="tooltiptextInfo">
                        Servidores em atenção
                    </span>
                </div>
                <div class="atention tooltipInfo" id="id_servidores_em_estado_de_alerta">
                    <p id="qtd_alerta"></p>
                    <span class="tooltiptextInfo">
                        Servidores em alerta
                    </span>
                </div>
            </div>
        </div>
    </header>
    <div class="container">
        <div>
            <H1>Resumo diário</H1>
            <p>Visão geral - Lançamentos e demandas</p>
        </div>
        <div class="resumo">
            <div class="resumoSituacao">
                <p><span>[ALERTA: RISCO ALTO] HOJE: XXXXX + LANÇAMENTOS DE JOGOS </span></p>
            </div>
            <div class="resumoKPIs">
                <div class="resumoCardKPI">
                    <div class="resumoCard">
                        <p>Jogos lançados</p>
                        <p class="resumoCardText">-</p>
                    </div>
                    <div class="resumoCard">
                        <p>Jogos lançados</p>
                        <p class="resumoCardText">-</p>
                    </div>
                </div>
                <div class="resumoCardHour">
                    <p>Demanda prevista</p>
                    <p class="titleHour">XX:XXh - XX:XXh</p>
                    <p class="ccuHour">- CCU</p>
                </div>
            </div>
        </div>
        <div class="listsContainer">
            <div class="listOutside">
                <div class="listHeader">
                    <p>Lançamentos do dia</p>
                    <p>XX-XX-XX</p>
                </div>
                <div class="listInside">
                    <div class="listGridHeader">
                        <div>Foto</div>
                        <div>Nome</div>
                        <div>Pontuação</div>
                        <div>CCU Previsto</div>
                    </div>
                    <div class="listItem" id="listLanc">
                        <div class="card">
                            <div class="listFoto"></div>
                            <div class="listNome">XXXX</div>
                            <div class="listPontuacao">YYY</div>
                            <div class="listCCU">ZZZZZZ</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="listOutside">
                <div class="listHeader">
                    <p>Jogos mais jogados</p>
                    <p>?????</p>
                </div>
                <div class="listInside">
                    <div class="listGridHeader_one">
                        <div>Foto</div>
                        <div>Nome</div>
                        <div>CCU Previsto</div>
                    </div>
                    <div class="listItem" id="top10">
                        <div class="card_one">
                            <div class="listFoto"></div>
                            <div class="listNome">XXXX</div>
                            <div class="listCCU">ZZZZZZ</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>


<script>
    header("dashboard", sessionStorage.CARGO_CARGO);

    function formatarHoje() {
        var diaDeHoje = new Date();
        var ano = diaDeHoje.getFullYear();
        var mes = diaDeHoje.getMonth() + 1;
        var dia = diaDeHoje.getDate();

        var dataFormatada = `${ano}-${mes}-${dia}`
        return dataFormatada;
    }
    var diaDeHoje = formatarHoje();

    function buscarLancamentos(chave, diaAtual) {
        var listLanc = document.getElementById("listLanc")

        fetch(`/s3Route/dados/${chave}`, {
            method: "GET",
            headers: {
                'Content-Type': 'application/json'
            }
        }).then((content) => {
            content.json().then((json) => {
                if (json.jogosLancados.length > 0) {
                    listLanc.innerHTML = "";
                }
                json.jogosLancados.forEach(jogos => {
                    console.log(jogos)
                    listLanc.innerHTML += `<div class="card">
                         <div class="bgLayer" style="background-image: url(${jogos.background_image})"></div>
                                    <div class="blurLayer"></div>
                                    <div class="listFoto"><img src="${jogos.background_image}"></img></div>
                                    <div class="listNome">${jogos.name}</div>
                                    <div class="listCCU">${jogos.ccu}</div>
                                </div>`
                })
            })
        })
    }

    function buscarTop10(chave, diaAtual) {
        var top10 = document.getElementById("top10")
        fetch(`/s3Route/dados/${chave}`, {
            method: "GET",
            headers: {
                'Content-Type': 'application/json'
            }
        }).then((content) => {
            content.json().then((json) => {
                console.log(json)
                if (json.jogosSteam.length > 0) {
                    top10.innerHTML = "";
                }
                json.jogosSteam.forEach(jogos => {
                    console.log(jogos)
                    top10.innerHTML += `<div class="card_one">
                                    <div class="bgLayer" style="background-image: url(${jogos.image})"></div>
                                    <div class="blurLayer"></div>
                                    <div class="listFoto_One"> <img src="${jogos.image}"></img></div>
                                    <div class="listNome">${jogos.name}</div>
                                    <div class="listCCU">${jogos.peak_in_game}</div>
                                </div>`
                })
            })
        })
    }

    var lancKey = `eduardo/Empresa%20Data%202/lancamentos_${diaDeHoje}.json`
    var steamKey = `eduardo/Empresa%20Data%202/steam_${diaDeHoje}.json`
    buscarLancamentos(lancKey, diaDeHoje);
    buscarTop10(steamKey, diaDeHoje);


</script>